{"version":3,"sources":["block-slider.js"],"names":["BlockSlider","collection","_ref","testTiming","timing","console","warn","lgStart","cache","slider","wrap","undefined","items","duration","sliderName","id","className","msg2","querySelector","wrapClass","Error","itemsClass","slice","call","children","e","message","calcTransiton","setAttribute","sliders","push","slidePosition","itemsPerSlide","itemWidth","wrapWidth","sliderWidth","slide","mouseOver","forEach","s","str","style","webkitTransform","msTransform","transform","hasReachedEnd","calcAndSetWidths","removeInlineWidths","opacity","removeProperty","item","i","arr","setWidths","width","length","offsetWidth","calcItemWidth","calcItemsPerSlide","Math","round","setTimeout","safariFixDelay","_ref$sInterval","sInterval","_ref$sTransition","sTransition","_ref$wrapClass","_ref$itemsClass","test","window","HTMLElement","resizeTimer","addEventListener","clearTimeout","setInterval","requestAnimationFrame","jQuery","$","fn","opts","this"],"mappings":"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","file":"block-slider.min.js","sourcesContent":["function BlockSlider(collection, {\r\n    sInterval = 2000,\r\n    sTransition = 400,\r\n    wrapClass = '.js-block-slider__wrap',\r\n    itemsClass = '.js-block-slider__items'\r\n}) {\r\n    'use strict';\r\n    const safariFixDelay = /constructor/i.test(window.HTMLElement) ? 500 : 0,\r\n        sliders = [],\r\n        lgStart = 'Block Slider: ';\r\n    let resizeTimer;\r\n    let mouseOver = false;\r\n\r\n    function testTiming(timing) {\r\n        if (typeof timing !== 'number') {\r\n            console.warn(`${lgStart}Supplied timing: '${timing}' is not an integer`);\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    if (! testTiming(sInterval)) {\r\n        sInterval = 2000;\r\n    }\r\n    if (! testTiming(sTransition)) {\r\n        sTransition = 400;\r\n    }\r\n    \r\n    try {\r\n        // can collection be found ?\r\n        if (!collection || !collection.length && !collection.querySelector) {\r\n            throw new Error(`${lgStart}Supplied slider(s) could not be found.`);\r\n        }\r\n    }\r\n    catch(e) {\r\n        console.warn(e.message);\r\n        return;\r\n    }\r\n\r\n    const calcTransiton = () => sTransition / 1000;\r\n\r\n    function cache(slider) {\r\n        let wrap,\r\n            items,\r\n            duration,\r\n            sliderName = slider.id ? '#' + slider.id : '.' + slider.className,\r\n            msg2 = ' could not be found as a direct descendant of ';\r\n        try {\r\n            wrap = slider.querySelector(wrapClass);\r\n            if (!wrap) {\r\n                throw new Error(`${lgStart}'${wrapClass}'${msg2}'${sliderName}.'`);\r\n            } \r\n            else {\r\n                items = wrap.querySelector(itemsClass);\r\n                if (!items) {\r\n                    throw new Error(`${lgStart}'${itemsClass}'${msg2}'${wrapClass}.'`);\r\n                } \r\n                else {\r\n                    items = [].slice.call(items.children, 0);                    \r\n                }\r\n            }\r\n        } \r\n        catch(e) {\r\n            console.warn(e.message);\r\n            return false;\r\n        }\r\n        duration = calcTransiton();\r\n        slider.setAttribute('style', 'overflow: hidden; opacity: 0');\r\n        wrap.setAttribute('style', `-webkit-transition: -webkit-transform ${duration}s;transition: transform ${duration}s;`);\r\n        sliders.push({\r\n            slider,\r\n            wrap,\r\n            items,\r\n            slidePosition: 0,\r\n            itemsPerSlide: 0,\r\n            itemWidth: 0,\r\n            wrapWidth: 0,\r\n            sliderWidth: 0\r\n        });\r\n    }\r\n    if (collection.length) {\r\n        [].forEach.call(collection, cache);\r\n    } else {\r\n        cache(collection);\r\n    }\r\n\r\n    const hasReachedEnd = s => -(s.slidePosition + 1) > s.wrapWidth - s.sliderWidth;\r\n\r\n    function slide() {\r\n        if(mouseOver) return;\r\n        sliders.forEach(s => {\r\n            const wrap = s.wrap,\r\n                str = `translate3d(${s.slidePosition}px, 0, 0)`;\r\n            wrap.style.webkitTransform = str;\r\n            wrap.style.msTransform = str;\r\n            wrap.style.transform = str;\r\n            s.slidePosition -= s.itemWidth;\r\n            if (hasReachedEnd(s)) {\r\n                s.slidePosition = 0;\r\n            }\r\n        });\r\n    }\r\n\r\n    function calcAndSetWidths() {\r\n        function removeInlineWidths(s) {\r\n            // Temporarily hide the slider\r\n            s.slider.style.opacity = 0;\r\n            // Remove widths for wrap and all items.\r\n            s.wrap.style.removeProperty('width');\r\n            s.items.forEach((item, i, arr) => {\r\n                item.style.removeProperty('width');\r\n            });\r\n        }\r\n\r\n        const calcItemWidth = s => s.items[0].offsetWidth;\r\n\r\n        const calcItemsPerSlide = s => Math.round(s.sliderWidth / s.itemWidth);\r\n\r\n        function setWidths(s) {\r\n            // loop through all items and set their width in pixels\r\n            // to the calculated width.\r\n            s.items.forEach((item) => {\r\n                item.style.width = s.itemWidth + 'px';\r\n            });\r\n            // Set wrap width equal to total width of items.\r\n            s.wrapWidth = s.itemWidth * s.items.length;\r\n            s.wrap.style.width = s.wrapWidth + 'px';\r\n            s.sliderWidth = s.slider.offsetWidth;\r\n        }\r\n\r\n        sliders.forEach(s => {\r\n            removeInlineWidths(s);\r\n            // create a slight delay for Safari being rubbishly slow at layout calcs.\r\n            setTimeout(() => {\r\n                // get the default CSS item width in pixels.\r\n                s.itemWidth = calcItemWidth(s);\r\n                setWidths(s);\r\n                s.itemsPerSlide = calcItemsPerSlide(s);\r\n                s.slidePosition = 0;\r\n                setTimeout(() => {\r\n                    // fade slider back in.\r\n                    s.slider.style.opacity = 1;\r\n                    slide();\r\n                }, safariFixDelay);\r\n            }, safariFixDelay);\r\n        });\r\n    }\r\n\r\n    calcAndSetWidths();\r\n\r\n    window.addEventListener('resize', () => {\r\n        // call setWidths once the screen has finished resizing.\r\n        clearTimeout(resizeTimer);\r\n        resizeTimer = setTimeout(calcAndSetWidths, 250);\r\n    });\r\n\r\n    collection.addEventListener('mouseover', () => {\r\n        //pause slider on mouseover\r\n        mouseOver = true;\r\n    });\r\n\r\n    collection.addEventListener('mouseout', () => {\r\n        //start slider on mouseout\r\n        mouseOver = false;\r\n    });\r\n\r\n\r\n    setInterval(() => {\r\n        if (requestAnimationFrame) {\r\n            requestAnimationFrame(() => {\r\n                slide(sliders);\r\n            });            \r\n        } else {\r\n            slide(sliders); \r\n        }\r\n    }, sInterval);\r\n}\r\n\r\n// if jQuery is present, create a plugin.\r\nif (window.jQuery) {\r\n    (($) => {\r\n        $.fn.BlockSlider = function(opts) {\r\n            BlockSlider(this, opts);\r\n            return this;\r\n        };\r\n    })(window.jQuery);\r\n}\r\n"]}